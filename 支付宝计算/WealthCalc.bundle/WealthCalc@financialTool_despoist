{"time":"0002","tplId":"WealthCalc@financialTool_despoist","publishVersion":"150603","tag":"WealthCalc","name":"financialTool_despoist","data":{"tag":"html","children":[{"tag":"head","children":[{"content":"text/html; charset=UTF-8","tag":"meta","http-equiv":"Content-Type"},{"tag":"meta","src":"WealthCalc.bundle/financial.i18n","type":"i18n"},{"tag":"style","children":[{"text":"div {display:flex; flex-direction:row; position: relative;}\n            \n            .cell_left_label {font-size:14px; color:#000000;}\n            .cell_right_label {font-size:14px; color:#666666;}","tag":"text"}]},{"tag":"script","children":[{"text":"var is_go_to_yuebao = false; \n\n            var itemIndex = 0;\n            var arrItem = new Array();\n            var arrLabelItem = new Array();\n            \n            var arrHuoText = new Array();\n            var index_rate_huo = 0;\n            var arrHuoRate = new Array();\n            \n            var old_total_money = \"\";\n            var old_total_day = \"\";\n            var total_money = 0;\n            var huo_day = 0;\n            \n            var extInfo;\n            \n            var arrDingText = new Array();\n            var arrDingRate = new Array();\n            var arrDingDay = new Array();\n            var index_rate_ding = 0;\n            \n            var rate_data;\n            \n            var is_loaded = false;\n\n        function changeItem(index) {\n                \n                arrItem[index].style.backgroundColor = \"#ffffff\";\n                arrItem[1-index].style.backgroundColor = \"#00aaee\";\n                \n                arrLabelItem[index].style.color = \"#00aaee\";\n                arrLabelItem[1-index].style.color = \"#ffffff\";\n                \n                if (index == 0) {\n                \tdocument.getElementById(\"label_cunkuanqixian\").innerText = \"{{存款期限(天)}}\";\n                \tdocument.getElementById(\"input_day\").style.display = \"flex\";\n                \tdocument.getElementById(\"div_ding\").style.display = \"none\";\n                \tdocument.getElementById(\"img_arrow_right\").style.display = \"flex\";\n                \t\n                \tdocument.getElementById(\"div_rate\").onclick = function () {\n                \t\t select_rate_huo();\n                \t}\n                \t\n                \tdocument.getElementById(\"div_days\").onclick = function () {\n                \t\t \n                \t}  \n                \t\n                \tsetup_huo_rate();              \t\n                }\n                else {\n                \tdocument.getElementById(\"label_cunkuanqixian\").innerText = \"{{存款期限}}\";\n                \tdocument.getElementById(\"input_day\").style.display = \"none\";\n                \tdocument.getElementById(\"div_ding\").style.display = \"flex\";\n                \tdocument.getElementById(\"img_arrow_right\").style.display = \"none\";\n                \t\n                \tdocument.getElementById(\"div_rate\").onclick = function () {\n\n                \t}\n                \t\n                \tdocument.getElementById(\"div_days\").onclick = function () {\n                \t\t select_rate_ding();\n                \t} \n                \t\n                \tsetup_ding_rate();\n                }\t\n                \n\t\t\t\tdocument.getElementById(\"input_money\").blur();\n                document.getElementById(\"input_day\").blur();\n                \n                total_calc();\n            }\n\n        function init_ui(data) {\n\n            is_loaded = true;\n\n            rate_data = JSON.stringify(data);\n\n            var rateList = data[\"currentDepositRateList\"];\n                        for (var i = 0; i < rateList.length; i++) {\n                            arrHuoText.push(rateList[i][\"rateName\"]);\n                            arrHuoRate.push(parseFloat(rateList[i][\"rate\"]));\n                        }\n                \n                        setup_huo_rate();\n                \n                        extInfo = data[\"extInfo\"];\n                \n                        changeItem(itemIndex);\n                \n                        var fixedDepositRateList = data[\"fixedDepositRateList\"];\n                        for (var i = 0; i < fixedDepositRateList.length; i++) {\n                            arrDingText.push(fixedDepositRateList[i][\"rateName\"]);\n                            arrDingRate.push(parseFloat(fixedDepositRateList[i][\"rate\"]));\n                            arrDingDay.push(parseFloat(fixedDepositRateList[i][\"period\"])/12);      \n                         \n                        }   \n\n                        document.getElementById(\"buttom_label\").innerText = \"{{以上为央行}}\" + data.extInfo.rateUpdateTime + \"{{最新公布的存款基准利率}}\";\n        }\n        \n        function init() {\n            \n            document.invoke(\"rpc\", {\n                \"operationType\": \"alipay.mwealth.toolkit.interest.queryDepositRate\",\n                \"requestData\": [{}]\n            }, function (rsp) {\n                \n                if (rsp.success) {\n\n                    var bizResult = rsp.result;\n                    if (bizResult.success) {\n                                                \n                        init_ui(bizResult);\n\n                        document.setProp(\"userPreferences\", {\n                                    \"key\":\"WealthCalc_yuedongweng_despoist\",\n                                    \"business\":\"WealthCalc\",\n                                    \"data\": bizResult\n                                });\n                \t} \n                \telse {\n\n\t\t\t\t\t   var bizResult = document.getProp(\"userPreferences\", {\n                                    \"key\":\"WealthCalc_yuedongweng_despoist\",\n                                    \"business\":\"WealthCalc\"\n                                });\n\n                                init_ui(JSON.parse(bizResult));\n                \t} \n                }\n                else {\n\n                    var bizResult = document.getProp(\"userPreferences\", {\n                                    \"key\":\"WealthCalc_yuedongweng_despoist\",\n                                    \"business\":\"WealthCalc\"\n                                });\n\n                                init_ui(JSON.parse(bizResult));\n                }\n            });\n            \n            arrItem.push(document.getElementById(\"item_a\"));\n            arrItem.push(document.getElementById(\"item_b\"));\n            \n            arrLabelItem.push(document.getElementById(\"label_a\"));\n            arrLabelItem.push(document.getElementById(\"label_b\"));\n        }\n        \n        function total_calc() {\n            \n            if (is_loaded == false)\n                return;\n\n            var money = (0).toFixed(2);\n            \n            if (itemIndex == 0) {\n                \n                if (total_money > 0 && huo_day > 0) {\n                    document.getElementById(\"lixi\").innerText = fmoney((total_money * huo_day * arrHuoRate[index_rate_huo] / 100 / 360).toFixed(2));\n                    document.getElementById(\"benxi\").innerText = fmoney((total_money * huo_day * arrHuoRate[index_rate_huo] / 100 / 360 + total_money).toFixed(2));\n                    \n                    money = (total_money * huo_day * parseFloat(extInfo[\"transferInRate\"]) / 100 / 360).toFixed(2);\n                }\n                else {\n                    document.getElementById(\"lixi\").innerText = \"0.00\";\n                    document.getElementById(\"benxi\").innerText = \"0.00\";\n                }\n                \n            }\n            else {\n            \tif (total_money > 0) {\n            \t\tdocument.getElementById(\"lixi\").innerText = fmoney((total_money * arrDingRate[index_rate_ding] / 100 * arrDingDay[index_rate_ding]).toFixed(2));\n            \t\tdocument.getElementById(\"benxi\").innerText = fmoney((total_money * arrDingRate[index_rate_ding] / 100 * arrDingDay[index_rate_ding] + total_money).toFixed(2));\n            \t\t\n            \t\tmoney = (total_money * arrDingDay[index_rate_ding]*12*30 * parseFloat(extInfo[\"transferInRate\"]) / 100 / 360).toFixed(2);\n            \t}\n            \telse {\n                    document.getElementById(\"lixi\").innerText = \"0.00\";\n                    document.getElementById(\"benxi\").innerText = \"0.00\";            \t\n            \t}\n            }\n            \n             if (extInfo) {\n                var text = extInfo[\"transferInText\"];\n                    \n                var temp = \" <font color='#ff6600'>\" + fmoney(money) + \"</font> \";\n                    \n                text = text.replace(\"money\", temp);\n                    \n                document.getElementById(\"ext_label\").innerText = text;\n                \n                document.getElementById(\"ext_label_zhuanru\").innerText = extInfo[\"transferInLabel\"];\n\n                if (money <= 0) {\n                \tdocument.getElementById(\"yuebao_zhuanru\").style.display = \"none\";\n                    is_go_to_yuebao = false;\n                }\n                else {\n                \tdocument.getElementById(\"yuebao_zhuanru\").style.display = \"flex\";\n                    is_go_to_yuebao = true;\n                }\n            }\n        }\n\n        function to_yuebao() {\n\n            if (is_loaded == false)\n                return;\n\n            if (is_go_to_yuebao) {\n\n                document.invoke(\"startApp\", {\n                        \"appId\" : \"20000032\",\n                        \"param\" : {\n                            \"animated\" : true\n                    \n                        }\n                });\n            }\n        }\n        \n        function setup_huo_rate() {\n            \n            if (is_loaded == false)\n                    return;\n\n            document.getElementById(\"label_huo_rate\").innerText = arrHuoRate[index_rate_huo];\n        }\n        \n        function setup_ding_rate() {\n            \n            if (is_loaded == false)\n                    return;\n\n            document.getElementById(\"label_huo_rate\").innerText = arrDingRate[index_rate_ding].toFixed(2);\n            document.getElementById(\"label_ding_rate\").innerText = arrDingText[index_rate_ding];\n        }\n        \n        function fmoney(s)  {\n            var l = s.split(\".\")[0].split(\"\").reverse();\n            \n            r = s.split(\".\")[1];\n            t = \"\";\n            \n            for(i = 0; i < l.length; i ++ ) {\n                t += l[i] + ((i + 1) % 3 == 0 && (i + 1) != l.length ? \",\" : \"\");\n            }\n            \n            var ret = t.split(\"\").reverse().join(\"\") ;\n            if (r != undefined) {\n                ret = ret + \".\" + r;\n            }\n            \n            return ret;\n        }\n        \n        function input_money() {\n            \n            var input = document.getElementById(\"input_money\").value;\n            \n            input = input.replace(/,/g,'');\n            \n            if (input == \".\")\n            input = \"0.\";\n            \n            if (input == \"\") {\n                old_total_money = \"\";\n            }\n            \n            var reg = \"^(([1-9]{1}\\\\d{0,6})|([0]{1}))(\\\\.(\\\\d){0,2})?$\";\n            var r = input.match(reg);\n            if(r==null) {\n                \n                document.getElementById(\"input_money\").value = fmoney(old_total_money);\n            }\n            else {\n                \n                old_total_money = input;\n                document.getElementById(\"input_money\").value = fmoney(input);\n            }\n            \n            total_money = parseFloat(old_total_money);\n            \n            total_calc();\n        }\n        \n        function input_day() {\n            \n            var input = document.getElementById(\"input_day\").value;\n            \n            if (input == \".\")\n            input = \"0.\";\n            \n            if (input == \"\" || input == \"0\") {\n                old_total_day = \"\";\n                input = \"\";\n            }\n            \n            var reg = \"^(([1-9]{1}\\\\d{0,3})|([0]{1}))?$\";\n            var r = input.match(reg);\n            if(r==null) {\n                \n                document.getElementById(\"input_day\").value = old_total_day;\n            }\n            else {\n                \n                old_total_day = input;\n                document.getElementById(\"input_day\").value = input;\n            }\n            \n            huo_day = parseFloat(old_total_day);\n            \n            total_calc();\n        }\n        \n        function select_rate_huo() {\n            \n            if (is_loaded == false)\n                    return;\n\n            var obj = {\n                'btns':arrHuoText,\n                'default':index_rate_huo,\n                'title':''\n            };\n            \n            document.picker(obj, function(data) {\n                            \n                            index_rate_huo = data.index;\n                            setup_huo_rate();\n                            total_calc();\n                            });\n        }\n        \n        function select_rate_ding() {\n            \n            if (is_loaded == false)\n                    return;\n\n            var obj = {\n                'btns':arrDingText,\n                'default':index_rate_ding,\n                'title':''\n            };\n            \n            document.picker(obj, function(data) {\n                            \n                index_rate_ding = data.index;\n                \tsetup_ding_rate();\n                    total_calc();\n            });\n        }\n        \n        function item_click() {\n            \n            itemIndex = 1-itemIndex;\n            changeItem(itemIndex);\n        }\n        \n        function onDespoist_rate() {\n        \t\n            if (is_loaded == false)\n                    return;\n\n        \tdocument.invoke('openPage', {\"tplId\": \"WealthCalc@financialTool_despoist_rate\", \"defaultTitle\":\"{{利率表}}\", \"initData\":rate_data, \"bundle\":\"WealthCalc\"});\n        }\n\n        function keydown_total_money() {\n\n            if (event.which == 10) {\n                if (itemIndex == 0) {\n                    document.getElementById(\"input_day\").focus();\n                }\n                else {\n                    document.getElementById(\"input_money\").blur();\n                }\n            }\n        }\n \n        function keydown_total_day() {\n\n            if (event.which == 10) {\n                document.getElementById(\"input_day\").focus();\n            }\n        }","tag":"text"}]}]},{"id":"bodyid","style":"flex-direction:column; height:100%; background-color:#f5f5f9;overflow:scroll;","onload":"init();","tag":"body","children":[{"tag":"nav","children":[{"tag":"div"},{"tag":"div"},{"tag":"div","children":[{"style":"padding:10px 0px 10px 10px;","tag":"div","children":[{"style":"font-size:14px; color:#ffffff;","tag":"label","children":[{"text":"{{利率表}}","tag":"text"}]}],"onclick":"onDespoist_rate()"}]}]},{"style":"background-color:#00aaee; height:137px; width:100%; flex-direction:column; align-items:center;","tag":"div","children":[{"style":"width:221px; height:23px; border-radius:4px; border:1px #ffffff solid; margin-top:12px;","tag":"div","children":[{"id":"item_a","style":"flex:1;align-items:center;justify-content:center; background-color:#ffffff;","tag":"div","children":[{"id":"label_a","style":"font-size:12px; color:#00aaee; ","tag":"label","children":[{"text":"{{活期}}","tag":"text"}]}],"onclick":"item_click()"},{"id":"item_b","style":"flex:1;align-items:center;justify-content:center; background-color:#00aaee;","tag":"div","children":[{"id":"label_b","style":"font-size:12px; color:#ffffff;","tag":"label","children":[{"text":"{{定期}}","tag":"text"}]}],"onclick":"item_click()"}]},{"style":"flex:1; width:100%;padding:22px 15px 10px 15px;","tag":"div","children":[{"style":"flex:1.001; flex-direction:column;","tag":"div","children":[{"style":"font-size:12px; color:#ffffff;","tag":"label","children":[{"text":"{{利息(元)}}","tag":"text"}]},{"id":"lixi","style":"font-size:29px; font-auto-adjust:true; color:#ffffff;  margin-top:8px; margin-right:15px; text-overflow:ellipsis; overflow:hidden; white-space:nowrap;","tag":"label"}]},{"style":"width:1PX; background-color:#4dc4f3;","tag":"div"},{"style":"flex:1; flex-direction:column; padding-left:15px;","tag":"div","children":[{"style":"font-size:12px; color:#ffffff;","tag":"label","children":[{"text":"{{本息合计(元)}}","tag":"text"}]},{"id":"benxi","style":"font-size:29px; font-auto-adjust:true; color:#ffffff; margin-top:8px; text-overflow:ellipsis; overflow:hidden; white-space:nowrap;","tag":"label"}]}]}]},{"style":"height:30px; background-color:#eaf4fa; align-items:center;","tag":"div","children":[{"id":"ext_label","style":"font-size:12px; color:#00aaee; margin-left:15px;","tag":"label"},{"style":"flex:1;","tag":"div"},{"id":"yuebao_zhuanru","style":"margin-right:15px; align-items:center; display:none;","tag":"div","children":[{"id":"ext_label_zhuanru","style":"font-size:12px; color:#ff6600; margin-right:4px;","tag":"label"},{"style":"width:8px; height:10px;","tag":"img","src":"WealthCalc.bundle/arrow"}],"onclick":"to_yuebao()"}]},{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"style":"background-color:#ffffff; flex-direction:column; padding-left:15px;","tag":"div","children":[{"style":"height:44px; padding-right:15px; align-items:center;","tag":"div","children":[{"tag":"label","children":[{"text":"{{存款总额(元)}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"input_money","style":"width:150px; text-align:right;","placeholder":"{{输入存款金额}}","tag":"input","onkeydown":"keydown_total_money()","type":"money","css":"cell_right_label","oninput":"input_money()"}]},{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"id":"div_days","style":"height:44px; padding-right:15px; align-items:center;","tag":"div","children":[{"id":"label_cunkuanqixian","tag":"label","children":[{"text":"{{存款期限(天)}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"input_day","style":"width:150px; text-align:right;","placeholder":"{{输入存款天数}}","tag":"input","onkeydown":"keydown_total_day()","type":"number","css":"cell_right_label","oninput":"input_day()"},{"id":"div_ding","style":"align-items:center; display:none;","tag":"div","children":[{"id":"label_ding_rate","style":"margin-right:5px;","tag":"label","css":"cell_right_label"},{"style":"height:13px; width:9px;","tag":"img","src":"APCommonUI.bundle/Tables_Arrow"}]}]},{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"id":"div_rate","style":"height:44px; align-items:center; padding-right:15px;","tag":"div","children":[{"tag":"label","children":[{"text":"{{年利率(%)}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"label_huo_rate","style":"text-align:right; margin-right:5px;","tag":"label","css":"cell_right_label"},{"id":"img_arrow_right","style":"height:13px; width:9px;","tag":"img","src":"APCommonUI.bundle/Tables_Arrow"}]}]},{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"id":"buttom_label","style":"font-size:12px; color:#999999; margin-left:15px; margin-top:4px;","tag":"label"}]}]},"format":"JSON","tplVersion":"5.0.6"}